!function(s){var i={};function n(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return s[t].call(e.exports,e,e.exports,n),e.l=!0,e.exports}n.m=s,n.c=i,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(s,i,function(t){return e[t]}.bind(null,i));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./admin/assets/js/playlist-edit.js")}({"./admin/assets/js/collections/tracks.js":function(t,e,s){"use strict";s.r(e),s.d(e,"Tracks",function(){return d});var i=s("backbone"),n=s.n(i),a=s("wp"),r=s.n(a),o=s("./admin/assets/js/modules/application.js"),l=s("./admin/assets/js/models/track.js"),d=n.a.Collection.extend({model:l.Track,comparator:function(t){return parseInt(t.get("order"),10)},fetch:function(){var e=this;return r.a.ajax.post("cue_get_playlist_tracks",{post_id:o.settings.postId}).done(function(t){return e.reset(t)})},save:function(t){return this.sort(),t=Object.assign({},t,{post_id:o.settings.postId,tracks:this.toJSON(),nonce:o.settings.saveNonce}),r.a.ajax.post("cue_save_playlist_tracks",t)}})},"./admin/assets/js/models/track.js":function(t,e,s){"use strict";s.r(e),s.d(e,"Track",function(){return n});var i=s("backbone"),n=s.n(i).a.Model.extend({defaults:{artist:"",artworkId:"",artworkUrl:"",audioId:"",audioUrl:"",format:"",length:"",title:"",order:0}})},"./admin/assets/js/modules/application.js":function(t,l,d){"use strict";d.r(l),function(t){d.d(l,"l10n",function(){return r}),d.d(l,"settings",function(){return o});var e=d("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=d.n(e),i=d("./node_modules/@babel/runtime/helpers/createClass.js"),n=d.n(i),a=function(){function t(){s()(this,t),this.l10n={},this.settings={}}return n()(t,[{key:"config",value:function(t){t.l10n&&(this.l10n=Object.assign(this.l10n,t.l10n),delete t.l10n),this.settings=Object.assign(this.settings,t)}}]),t}();t.cue=t.cue||new a,l.default=t.cue;var r=t.cue.l10n,o=t.cue.settings}.call(this,d("./node_modules/webpack/buildin/global.js"))},"./admin/assets/js/modules/workflows.js":function(t,e,s){"use strict";s.r(e);var i=s("underscore"),n=s.n(i),a=s("wp"),r=s.n(a),o=s("./admin/assets/js/modules/application.js"),l=s("./admin/assets/js/views/frame/track-media.js"),d=r.a.media.model.Attachment,c=o.default.l10n;e.default={frames:[],model:{},setModel:function(t){return this.model=t,this},get:function(t){var e="_"+t,s=this.frames[e]||null,s=this[e].call(this,s);return this.frames[e]=s},_addTracks:function(t){return t||((t=new l.TrackMediaFrame({title:c.workflows.addTracks.frameTitle,library:{type:"audio"},button:{text:c.workflows.addTracks.frameButtonText},multiple:"add"})).uploader.options.uploader.plupload={filters:{mime_types:[{title:c.workflows.addTracks.fileTypes,extensions:"m4a,mp3,ogg,wma"}]}},t.state("embed").props.off("change:url",t.state("embed").debouncedScan),t.state("insert").on("insert",function(t){n.a.each(t.models,function(t){o.default.tracks.push(t.toJSON().cue)})}),t.state("embed").on("select",function(){var t=this.props.toJSON(),e={audioId:"",audioUrl:t.url};"title"in t&&""!==t.title&&(e.title=t.title),o.default.tracks.push(e)}),t)},_selectArtwork:function(t){var i=this;return t||((t=r.a.media({title:c.workflows.selectArtwork.frameTitle,library:{type:"image"},button:{text:c.workflows.selectArtwork.frameButtonText},multiple:!1})).uploader.options.uploader.plupload={filters:{mime_types:[{files:c.workflows.selectArtwork.fileTypes,extensions:"jpg,jpeg,gif,png"}]}},t.on("open",function(){var t=this.get("library").get("selection"),e=i.model.get("artworkId"),s=[];e&&(s.push(d.get(e)),s[0].fetch()),t.reset(s)}),t.state("library").on("select",function(){var t=this.get("selection").first().toJSON();i.model.set({artworkId:t.id,artworkUrl:t.sizes.cue.url})}),t)},_selectAudio:function(a){var r=this;return a||((a=new l.TrackMediaFrame({title:c.workflows.selectAudio.frameTitle,library:{type:"audio"},button:{text:c.workflows.selectAudio.frameButtonText},multiple:!1})).uploader.options.uploader.plupload={filters:{mime_types:[{title:c.workflows.selectAudio.fileTypes,extensions:"m4a,mp3,ogg,wma"}]}},a.state("embed").props.off("change:url",a.state("embed").debouncedScan),a.on("open",function(){var t=this.get("insert").get("selection"),e=r.model.get("audioId"),s=r.model.get("audioUrl"),i=s&&!e,n=[];e&&(n.push(d.get(e)),n[0].fetch()),t.reset(n),i?this.get("embed").props.set({url:s,title:r.model.get("title")}):this.get("embed").props.set({url:"",title:""}),a.setState(i?"embed":"insert")}),a.state("insert").on("insert",function(t){var s=t.first().toJSON().cue,i={},e=n.a.keys(r.model.attributes);n.a.without(e,["id","order"]),n.a.each(e,function(t){var e=r.model.get(t);!e&&t in s&&e!==s[t]&&(i[t]=s[t])}),i.audioId=s.audioId,i.audioUrl=s.audioUrl,r.model.set(i)}),a.state("embed").on("select",function(){var t=this.props.toJSON(),e={audioId:""};e.audioUrl=t.url,"title"in t&&""!==t.title&&(e.title=t.title),r.model.set(e)}),a.on("escape",function(){var t=r.model.toJSON();t.artworkUrl||t.audioUrl||r.model.destroy()}),a)}}},"./admin/assets/js/playlist-edit.js":function(t,e,s){"use strict";s.r(e);var i=s("jquery"),n=s.n(i),a=s("wp"),r=s.n(a),o=s("./admin/assets/js/modules/application.js"),l=s("./admin/assets/js/views/screen/edit-playlist.js"),d=s("./admin/assets/js/models/track.js"),c=s("./admin/assets/js/collections/tracks.js"),u=s("./admin/assets/js/modules/workflows.js");o.default.data=_cueSettings,o.default.config(_cueSettings),r.a.media.view.settings.post.id=o.default.data.postId,r.a.media.view.settings.defaultProps={},Object.assign(o.default,{collection:{},controller:{},model:{},view:{}}),o.default.model.Track=d.Track,o.default.model.Tracks=c.Tracks,o.default.workflows=u.default,n()(function(t){var e=new o.default.model.Tracks(o.default.data.tracks);o.default.tracks=e,delete o.default.data.tracks,new l.EditPlaylistScreen({el:"#post",collection:e,l10n:o.default.l10n}).render()})},"./admin/assets/js/views/edit-playlist/track-list.js":function(t,e,s){"use strict";s.r(e),s.d(e,"TrackList",function(){return c});var i=s("jquery"),n=s.n(i),a=s("underscore"),r=s.n(a),o=s("wp"),l=s.n(o),d=s("./admin/assets/js/views/edit-playlist/track/index.js"),c=l.a.Backbone.View.extend({className:"cue-tracklist",tagName:"ol",initialize:function(){this.listenTo(this.collection,"add",this.addTrack),this.listenTo(this.collection,"add remove",this.updateOrder),this.listenTo(this.collection,"reset",this.render)},render:function(){var t=this;return this.$el.empty(),this.collection.each(this.addTrack,this),this.updateOrder(),this.$el.sortable({axis:"y",delay:150,forceHelperSize:!0,forcePlaceholderSize:!0,opacity:.6,start:function(t,e){e.placeholder.css("visibility","visible")},update:function(){t.updateOrder()}}),this},addTrack:function(t){var e=new d.Track({model:t});this.$el.append(e.render().el)},updateOrder:function(){var i=this;r.a.each(this.$el.find(".cue-track"),function(t,e){var s=n()(t).data("cid");i.collection.get(s).set("order",e)})}})},"./admin/assets/js/views/edit-playlist/track/artwork.js":function(t,e,s){"use strict";s.r(e),s.d(e,"TrackArtwork",function(){return l});var i=s("underscore"),n=s.n(i),a=s("wp"),r=s.n(a),o=s("./admin/assets/js/modules/workflows.js"),l=r.a.Backbone.View.extend({tagName:"span",className:"cue-track-artwork",template:r.a.template("cue-playlist-track-artwork"),events:{click:"select"},initialize:function(t){this.parent=t.parent,this.listenTo(this.model,"change:artworkUrl",this.render)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.parent.$el.toggleClass("has-artwork",!n.a.isEmpty(this.model.get("artworkUrl"))),this},select:function(){o.default.setModel(this.model).get("selectArtwork").open()}})},"./admin/assets/js/views/edit-playlist/track/audio.js":function(t,e,s){"use strict";s.r(e),s.d(e,"TrackAudio",function(){return u});var i=s("jquery"),n=s.n(i),a=s("mediaelementjs"),r=s.n(a),o=s("wp"),l=s.n(o),d=s("./admin/assets/js/modules/application.js"),c=s("./admin/assets/js/modules/workflows.js"),u=l.a.Backbone.View.extend({tagName:"span",className:"cue-track-audio",template:l.a.template("cue-playlist-track-audio"),events:{"click .cue-track-audio-selector":"select"},initialize:function(t){this.parent=t.parent,this.listenTo(this.model,"change:audioUrl",this.refresh),this.listenTo(this.model,"destroy",this.cleanup)},render:function(){var t=this.model.toJSON(),e=this.$el.find(".mejs-audio").attr("id");""===t.audioUrl&&e&&r.a.players[e].remove(),this.$el.html(this.template(this.model.toJSON()));var s,i=this.$el.find(".cue-audio");return i.length&&(i.wrap("<body></body>"),s={classPrefix:"mejs-",defaultAudioHeight:30,features:["playpause","current","progress","duration"],pluginPath:d.settings.pluginPath,stretching:"responsive",success:function(t,e,s){var i=n()(s.container).parent();n.a.nodeName(i.get(0),"body")&&i.replaceWith(i.get(0).childNodes)},error:function(t){var e=n()(t),s=e.closest(".cue-track"),i=e.closest(".mejs-audio").attr("id");r.a.players[i].remove(),s.find("audio").remove()}},"m4a"===i.attr("src").split(".").pop()&&(s.pluginVars="isvideo=true"),i.mediaelementplayer(s)),this},refresh:function(){var t=this.model.toJSON(),e=this.$el.find(".mejs-audio").attr("id"),s=e?r.a.players[e]:null;s&&""!==t.audioUrl?(s.pause(),s.setSrc(t.audioUrl)):this.render()},cleanup:function(){var t=this.$el.find(".mejs-audio").attr("id"),e=t?r.a.players[t]:null;e&&e.remove()},select:function(){c.default.setModel(this.model).get("selectAudio").open()}})},"./admin/assets/js/views/edit-playlist/track/index.js":function(t,e,s){"use strict";s.r(e),s.d(e,"Track",function(){return d});var i=s("jquery"),n=s.n(i),a=s("wp"),r=s.n(a),o=s("./admin/assets/js/views/edit-playlist/track/artwork.js"),l=s("./admin/assets/js/views/edit-playlist/track/audio.js"),d=r.a.Backbone.View.extend({tagName:"li",className:"cue-track",template:r.a.template("cue-playlist-track"),events:{"change [data-setting]":"updateAttribute","click .js-toggle":"toggleOpenStatus","dblclick .cue-track-title":"toggleOpenStatus","click .js-close":"minimize","click .js-remove":"destroy"},initialize:function(){this.listenTo(this.model,"change:title",this.updateTitle),this.listenTo(this.model,"change",this.updateFields),this.listenTo(this.model,"destroy",this.remove)},render:function(){return this.$el.html(this.template(this.model.toJSON())).data("cid",this.model.cid),this.views.add(".cue-track-column-artwork",new o.TrackArtwork({model:this.model,parent:this})),this.views.add(".cue-track-audio-group",new l.TrackAudio({model:this.model,parent:this})),this},minimize:function(t){t.preventDefault(),this.$el.removeClass("is-open").find("input:focus").blur()},toggleOpenStatus:function(t){t.preventDefault(),this.$el.toggleClass("is-open").find("input:focus").blur(),this.$el.hasClass("is-open")&&n()(window).trigger("resize")},updateAttribute:function(t){var e=n()(t.target).data("setting"),s=t.target.value;this.model.get(e)!==s&&this.model.set(e,s)},updateFields:function(){var t=this.model.toJSON(),e=this.$el.find("[data-setting]");for(var s in t){var i=n()("<div/>").html(t[s]).text();e.filter('[data-setting="'+s+'"]').val(i)}},updateTitle:function(){var t=this.model.get("title");this.$el.find(".cue-track-title .text").text(t||"Title")},destroy:function(){this.model.trigger("destroy",this.model)},remove:function(){this.$el.remove()}})},"./admin/assets/js/views/frame/track-media.js":function(t,e,s){"use strict";s.r(e),s.d(e,"TrackMediaFrame",function(){return u});var i=s("wp"),n=s.n(i),a=s("./admin/assets/js/modules/application.js"),r=n.a.media.view,o=r.MediaFrame,l=r.Toolbar,d=o.Post,c=o.Select,u=d.extend({createStates:function(){var t=this.options;this.states.add([new n.a.media.controller.Library({id:"insert",title:t.title,priority:20,toolbar:"main-insert",filterable:"uploaded",library:n.a.media.query(t.library),multiple:!!t.multiple&&"reset",editable:!1,allowLocalEdits:!0,displaySettings:!1,displayUserSettings:!1}),new n.a.media.controller.Embed({title:a.l10n.addFromUrl,menuItem:{text:a.l10n.addFromUrl,priority:120},type:"link"})])},bindHandlers:function(){c.prototype.bindHandlers.apply(this,arguments),this.on("toolbar:create:main-insert",this.createToolbar,this),this.on("toolbar:create:main-embed",this.mainEmbedToolbar,this),this.on("menu:render:default",this.mainMenu,this),this.on("content:render:embed",this.embedContent,this),this.on("content:render:edit-selection",this.editSelectionContent,this),this.on("toolbar:render:main-insert",this.mainInsertToolbar,this)},mainInsertToolbar:function(t){var s=this;this.selectionStatusToolbar(t),t.set("insert",{style:"primary",priority:80,text:this.options.button.text,requires:{selection:!0},click:function(){var t=s.state(),e=t.get("selection");s.close(),t.trigger("insert",e).reset()}})},mainEmbedToolbar:function(t){t.view=new l.Embed({controller:this,text:this.options.button.text})}})},"./admin/assets/js/views/screen/button/add-tracks.js":function(t,e,s){"use strict";s.r(e),s.d(e,"AddTracksButton",function(){return l});var i=s("jquery"),n=s.n(i),a=s("wp"),r=s.n(a),o=s("./admin/assets/js/modules/workflows.js"),l=r.a.Backbone.View.extend({id:"add-tracks",tagName:"p",events:{"click .button":"click"},initialize:function(t){this.l10n=t.l10n},render:function(){var t=n()("<a />",{text:this.l10n.addTracks}).addClass("button button-secondary");return this.$el.html(t),this},click:function(t){t.preventDefault(),o.default.get("addTracks").open()}})},"./admin/assets/js/views/screen/edit-playlist.js":function(t,e,s){"use strict";s.r(e),s.d(e,"EditPlaylistScreen",function(){return d});var i=s("jquery"),n=s.n(i),a=s("wp"),r=s.n(a),o=s("./admin/assets/js/views/screen/button/add-tracks.js"),l=s("./admin/assets/js/views/edit-playlist/track-list.js"),d=r.a.Backbone.View.extend({saved:!1,events:{"click #publish":"buttonClick","click #save-post":"buttonClick"},initialize:function(t){this.l10n=t.l10n},render:function(){return this.views.add("#cue-playlist-editor .cue-panel-body",[new o.AddTracksButton({collection:this.collection,l10n:this.l10n}),new l.TrackList({collection:this.collection})]),this},buttonClick:function(t){var e=this,s=n()(t.target);return this.saved||this.collection.save().done(function(t){e.saved=!0,s.click()}),this.saved}})},"./node_modules/@babel/runtime/helpers/classCallCheck.js":function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},"./node_modules/@babel/runtime/helpers/createClass.js":function(t,e){function i(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,s){return e&&i(t.prototype,e),s&&i(t,s),t}},"./node_modules/webpack/buildin/global.js":function(t,e){var s=function(){return this}();try{s=s||new Function("return this")()}catch(t){"object"==typeof window&&(s=window)}t.exports=s},backbone:function(t,e){t.exports=Backbone},jquery:function(t,e){t.exports=jQuery},mediaelementjs:function(t,e){t.exports=mejs},underscore:function(t,e){t.exports=_},wp:function(t,e){t.exports=wp}});